---
title: "Lab-6 Time Series Analysis of Temperature Deviations Using ARMA Modeling"
author: "Thulasi-2348152"
date: "2024-03-28"
output:
  word_document: default
  html_document: default
---
## Introduction
AutoRegressive (AR): It predicts the current value of a series based on its past values. The AR component considers how past values of the series contribute to the current value. For example, an AR(1) model uses the immediate past value to predict the current value.

Moving Average (MA): It predicts the current value of a series based on past forecast errors. The MA component considers the error terms from previous predictions. For example, an MA(1) model uses the immediate past forecast error to improve the current prediction.

Together, the AR and MA components form an ARMA model, which can capture both the linear dependence on past values and the short-term dependency on past forecast errors in the time series data. ARMA models are commonly used for time series forecasting due to their simplicity and effectiveness in capturing various patterns in the data.

## Objectives
* Fit Suitable ARMA Model
* Suitable ARMA Model Selection
* Fit Selected ARMA Model
* Residual Analysis for Best-Fit Model

## Data Desciption
The xgloptemp dataset contains 136 observations. It measures temperature deviations in degrees Celsius for the years 1880 to 2015.

```{r}
library(astsa)
Dataset=xglobtemp
class(Dataset)
ts.plot(Dataset)
```

There is overall general increasing trend and no seasonlaity.
```{r}
acf(Dataset,lag=50)
```

From the acf plot we see that the data is non stationary since all the lags lies beyond the threshold
limit.

### Augmented Dickey-Fuller Test
* $H_0$:Time series is non-stationary
* $H_1$:Time series is stationary
```{r}
library(tseries)
adf.test(Dataset)
```

P-value 0.73>0.05 we accept Ho .Hence the ts is non-stationary model.

## First Order Differencing
```{r}
diffdata=diff(Dataset)
acf(diffdata)
```

There is one significant lag at lag 1.Which tell that the model may be MA(1).
```{r}
pacf(diffdata)
```

There are three signjficant lags and hence it may be AR(3)model.
```{r}
library(forecast)
auto.arima(diffdata)
```

The AIC of ARMA(1,3) is -234.12.Now we will check the AIC of AR(1) and MA(3).
```{r}
ar1=arima(diffdata,order=c(1,0,0))
ar1
```

ARMA(1,0) has -218.16 AIC value.
```{r}
ma3=arima(diffdata,order=c(0,0,3))
ma3
```

AIC of MA(3) model is -230.93.
ARMA(1,3) has the least AIC value .Hence we will choose it has our best model.

## Residual Analysis

### Shapiro-Wilk Test
* $H_0$:The residuals are normally distributed
* $H_1$:The residuals are not normally distributed.

```{r}
library(lmtest)
fit=arima(order=c(1,0,3),diffdata)
residual=resid(fit)
shapiro.test(residual)
```

Since P-value 0.26>0.05 ,we reject our Ho and Hence residuals follows normality.

### Ljung-Box Test
* $H_0$:The residuals are independently distributed (no autocorrelation).
* $H_1$:The residuals are not independently distributed (autocorrelation is present).

```{r}
Box.test(residual,lag=4)
```
pvalue 0.90 >0.05,we accept ho and hence residuals are not autocorrelated.

### White Test
* $H_0$:The residuals exhibit constant variance (homoscedasticity)
* $H_1$:The residuals do not exhibit constant variance (heteroscedasticity).

```{r}
white.test(residual)
```

 p-value 0.86>0.05,we accept ho and hence residuals have constant variance.

## Conclusion 
In this analysis, we explored the temperature deviations dataset using ARMA modeling techniques. The data exhibited an overall increasing trend with no apparent seasonality. After confirming non-stationarity using the Augmented Dickey-Fuller Test, we applied first-order differencing to achieve stationarity.

The autocorrelation function (ACF) and partial autocorrelation function (PACF) plots suggested potential AR(3) and MA(1) models, respectively. We used the auto.arima function to select the best model based on the lowest AIC value, which turned out to be ARMA(1,3).

Residual analysis confirmed that the selected ARMA(1,3) model adequately captured the underlying patterns in the data. The Shapiro-Wilk test indicated that the residuals followed a normal distribution, while the Ljung-Box test and White test demonstrated that the residuals were independent and exhibited constant variance, respectively.